<p class="z-h s_clear">
  <strong class="left">请求加入</strong>
  <%= link_to_function '', "facebox.close();", :class => "icon2-close right" %>
</p>

<div class="z-con">
<% form_remote_for :request, :url => event_requests_url(@event, :show => params[:show]), :html => {:method => :post, :onsubmit=> "Iyxzone.disableButton($(new_event_request_btn),'请等待..');"} do |f| %>
<div class='formcontent'>
  <div class="rows s_clear">
    <% if @characters.blank? %>
      <div class='tip'>你所有的游戏角色都已经在这个活动了，或者被邀请，或者已经发送请求了</div>
    <% else %>
      <% if !@request_characters.blank? %>
        <div class='tip'>你的 <%= @request_characters.map(&:name).join(', ') %> 已经请求加入了这个活动</div>
      <% end %>
      <% if !@invite_characters.blank? %>
        <div class='tip'>你的 <%= @invite_characters.map(&:name).join(', ') %> 已经被邀请加入这个活动了</div>
      <% end %>
      <% if !@confirmed_and_maybe_characters.blank? %>
        <div class='tip'>你的 <%= @confirmed_and_maybe_characters.map(&:name).join(', ') %> 已经加入这个活动了</div>
      <% end %>
      <div class='tip'>你还可以选择 <%= collection_select :request, :character_id, @characters, :id, :name, {:prompt => '---'} %> 加入这个活动? </div>
    <% end %>
  </div>
</div>
<div class="z-submit s_clear space">
  <table class="center" cellpadding="0"><tr><td>
    <% unless @characters.blank? %>
    <span class="button"><span><button type="submit" id='new_event_request_btn'>完成</button></span></span>
    <% end %>
    <span class="button button-gray"><span><button type="button" onclick="facebox.close();">取消</button></span></span>
  </td></tr></table>
</div>
<% end %>
</div>
