<table class="photo-edit-list">
  <% k = photos.size/4 %>
  <% 0.upto(k) { |i| %>
    <% if k == i%>
      <% n = photos.size % 4 - 1 %>
    <% else %>
      <% n = 3 %>
    <% end %>
    <% j = i*4 %>
    <tr>
      <% photos[j..j+n].each do |p| %>                         
        <td valign="bottom" width=25%>
          <%= photo_link p, :class => 'imgbox02' %>
        </td>
      <% end %>
      <% if n < 3 %>
        <td valign="bottom" width=25%></td>
        <td valign="bottom" width=25%></td>
      <% end %>
    </tr>
    <% if album.poster == current_user %>
      <tr>
        <% photos[j..j+n].each do |photo| %>
          <td>
          <% if !photo.is_cover? %>
            <%= facebox_confirm '', avatar_url(photo, :at => 'album', :photo => {:is_cover => 1}), {:msg => "你确定要把这张照片设为头像吗", :method => :put}, {:class => 'icon-active icon-active-camera'} %>
          <% end %>
          <%= facebox_link "", edit_avatar_url(photo, :at => 'album'), :class => "icon-active icon-active-edit" %>
          <% if !photo.is_cover? %>
            <%= facebox_confirm '', avatar_url(photo), {:msg => '你确定要删除这张图片吗', :method => 'delete'}, {:class => "icon-active"} %>
          <% end %>
          </td>
        <% end %>
        <td></td></td></td>
      </tr>
    <% end %>
  <% } %>
  <%= will_paginate photos %>
</table>
